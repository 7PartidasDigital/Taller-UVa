---
title: "R para los de Letras"
author: "J. M. Fradejas"
date: "2024.12.18"
output:
  html_document:
    df_print: paged
---

<div>
<center>
<img src="https://fyl.uva.es/wp-content/uploads/2020/07/fyluva-logo.png" width="350"/>
</center>
</div>


# Introducci√≥n

Este documento contiene los instrucciones para el taller *R para los de Letras* ofrecido por la [Facultad de Filosof√≠a y Letras](https://fyl.uva.es/) de la [Universidad de Valladolid](https://www.uva.es/export/sites/uva/).

El objetivo de este taller es introducirse en el uso de R como herramienta para analizar datos textuales, pero ofrece informaci√≥n valiosa para cualquiera que quiera introducirse en R. 

Este taller est√° dirigido a principiantes con el objetivo de mostrar c√≥mo configurar una sesi√≥n de R en RStudio, c√≥mo configurar proyectos en R y c√≥mo realizar operaciones b√°sicas usando R.

## Los objetivos de este taller{-}

Los objetivos de este taller son:

- Instalar R 
- C√≥mo moverse en R y RStudio
- C√≥mo crear y trabajar con proyectos en R
- D√≥nde buscar ayuda y aprender m√°s acerca de R
- Comprender los principios b√°sicos al trabajar con datos: cargarlos, guardarlos, trabajar con tablas, crear un gr√°fico sencillo


## Audiencia{-}

Este taller es para principiantes. No es necesario saber nada de R, ni de lenguas de programaci√≥n.

Se ruega que todos los participantes traigan su propio ordenador con el software ya instalado. Al usar su propio ordenador, nos aseguramos de que tras el taller podr√°n continuar usando lo que se ha aprendido una vez haya finalizado el taller.


## Instalar R y RStudio{-}

Durante el taller, se usar√° RSudio. RStudio es un exelente manera de manejar el lenguaje de programaci√≥n R. Para usarlo, debes intalar tanto R como RStudio.

Por favor, sigue las instrucciones que hay a continuaci√≥n para instalar R y RStudio y hazlo antes de acudir al taller. Aseg√∫rate de que el software funciona que debe una vez instalado. ¬°Te diremos c√≥mo hacerlo!

<div>
<center>
<img src="https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/UHFbanner-MSlogo?fmt=png-alpha&bfc=off&qlt=100,1"/>
</center>
</div>

  + Tiene un ordenador con Windows?
  
    - Descarga R. [Este enlace lo desacargar√°](https://cran.rediris.es/bin/windows/base/R-4.4.2-win.exe)
    - Ejecuta el fichero `.exe` que acabas de descargar (se encuentra en la carpeta `Descargas`), y sigue sus instrucciones
    - Ahora descarga RStudio. [Este enlace lo descargar√°](https://download1.rstudio.org/electron/windows/RStudio-2024.12.0-467.exe)
    - Cuando se haya descargado, ejecuta el fichero `R-4.4.2-win.exe` (estar√° en la carpeta `Descargas`), y sigue las instrucciones
    - Una vez haya finalizado la instalaci√≥n, abre Rstudio y aseg√∫rate de que funciona y de que no hay mensajes de error.

<div>
<center>
<img src="https://upload.wikimedia.org/wikipedia/commons/thumb/3/30/MacOS_logo.svg/240px-MacOS_logo.svg.png" width="70px"/>
</center>
</div>

  + Tienes un Mac? 

    - Desarga R. Si tienes un ordenador con los chips M1/M2/M3/M4 [usa este enlace](https://cran.rediris.es/bin/macosx/big-sur-arm64/base/R-4.4.2-arm64.pkg), pero si tu ordenador tiene un procesador Intel, entonces [usa este otro enlace](https://cran.rediris.es/bin/macosx/big-sur-x86_64/base/R-4.4.2-x86_64.pkg)
    - Ejecuta el fichero `.pkg` que acaba de bajar (estar√° en la carpeta `Descargas`), y sigue las instrucciones
    - Ahora descarga RStudio. [Este enlace lo descargar√°](https://download1.rstudio.org/electron/macos/RStudio-2024.12.0-467.dmg)
    - Cuando se haya descargado, ejecuta el fichero `R-4.4.2-arm64.pkg` o `R-4.4.2-x86_64.pkg` (estar√° en la carpeta `Descargas`), y sigue las instrucciones
    - Una vez que se haya finalizado la instalaci√≥n, abre Rstudio y aseg√∫rate de que funciona y de que no haya mensajes de error.
    
Cuando arranques RStudio, ver√°s que se parece a esta imagen (el fondo ser√° blanco y no negro):

```{r mlex01, echo=F, fig.cap="", message=FALSE, warning=FALSE, out.width='100%', fig.align="center"}
knitr::include_graphics("https://raw.githubusercontent.com/7PartidasDigital/Taller-UVa/master/images/UVa_001.png")
``` 

# R y RStudio. Lo b√°sico{-}

RStudio es un IDE - Integrated Development Environment, una especie de escritorio que facilita el acceso a R. La gran ventaja es de este aplicativo es que se pueden gestionar con gran facilidad los _scripts_ de R, los ficheros y los directorios de los proyectos. Este entorno de trabajo permite editar y ejecutar el c√≥digo (_scripts_), ver los resultados y los gr√°ficos que trace. Es m√°s, se pueden ver las variables y los objetos que se est√°n ejecutando en la ventana `Environment`(m√°s, m√°s abajo üëá).

## RStudio: Paneles{-}

El escritorio de RStudio divide la pantalla en cuatro ventanas que llama **panes** (o **paneles**):

1. Editor de ficheros
2. Environment
3. Console
4. Gestion (Gestor de ficheros (_Files_), Gr√°fico (_plots_), Ayuda (_help_), Visor (_Viewer), Presentaci√≥n (_Presentation_) y Librar√≠as (_packages_).

Los dos m√°s importante son la Consola (parte inferior, abajo) y el editor de ficheros (parte superior, izquierda).
Los paneles de variables gesti√≥n est√°n en la parte de derecha y tienen varias pesta√±as: 

* **Environment** (arriba): Presenta todos los objetos, variables, y conjunto de datos (_data sets_) que se est√°n usando.
* **History** (arriba): Recoge todas las instrucciones ejecutadas rencientemente o que est√°n asociadasa un proyecto determinado
* **Plots** (abajo): Cualquier gr√°fico se imprimir√° en ese espacio
* **Help** (abajo): es donde buscar la ayuda la cualquier librer√≠a o funci√≥n. Si escribes `?` y el nombre de una funci√≥n en la consola, la ayuda aparecer√° en la ventana **Help**. 
* **Files** (abajo): Muesrtra los ficheros que hay en el directorio de trabajo, y tienes varias posibilidades (crear nuevos directorios o carpetas (_New Folder_), crear un nuevo fichero (_New File_), borrarlo (_Delete_), renombrarlo (_Rename_) y otras varias posibilidades en ‚öôÔ∏è _More_)

### Consola de R (panel, ventana inferior izquierdo){-}

La consola permite ejecutar inemdiatamente cualquier funci√≥n o instrucci√≥n de R. Aqu√≠ puedes experimentar con las funciones, o, sencillamente, imprimir los datos para verlos.
 
Para usarlo hay que escribir la orden tras `>` y pulsar ‚èé para ejecutar la orden que se quiera que realice R.

***

<div class="warning" style='padding:0.1em; background-color:#00802B; color:#f2f2f2'>
<span>
<p style='margin-top:1em; text-align:center'>
<b>PRIMER EJERCICIO</b></p>
<p style='margin-left:1em;'>
</p></span>
</div>

<div class="question">` 

1. Puedes utilizar R como una sencilla calculadora. Escribe `2+8` en la **consola**, como te muestro en la imagen que hay a continuaci√≥n, y pulsa ‚èé.

```{r echo=F, fig.cap="", message=FALSE, warning=FALSE, out.width='75%', fig.align="center"}
knitr::include_graphics("https://raw.githubusercontent.com/7PartidasDigital/Taller-UVa/master/images/UVa_002.png")
```

<details>
  <summary>Respuesta</summary>

```{r calculator, echo=FALSE}
  2+8
```
</details>
</div>

***

En esta orden, el signo de adici√≥n `+` es el **operador**. Los operadores son s√≠mbolos que representan alg√∫n tipo de acci√≥n. R, sin embargo, es much√≠sima m√°s que una sencilla calculadora. Para poderle sacar el m√°ximo partido es necesario comprender que son los **objetos**, las **funciones** y los **√≠ndices** (el n√∫mero que aparece entre corchetes en los resultados que se imprimen en la consola). Aprender√°s c√≥mo usarlos seg√∫n avanzamos.

Por ahora, considera que los *objetos* son *nombres* y que las *funciones* son *verbos*. 

## El editor de _scripts_ (arriba a la izquierda){-}

La ventana del editor solo se abre si se le dice que se abra. es muy flexible puesto que permite moverte por el texto de un _script_, y colorear√° los diversos componentes de una expresi√≥n (u orden o comando). Te permite guardar el _script_, reutilizarlo o corregir los errores sin tener que reescribir todo. La manera de abrir el editor es haciendo clic en `File`


```{r mlex02, echo=F, fig.cap="", message=FALSE, warning=FALSE, fig.align="center", out.width='75%'}
knitr::include_graphics('https://raw.githubusercontent.com/7PartidasDigital/Taller-UVa/master/images/UVa_003.png')
``` 

Ahora haz clic en `New File` y, por √∫ltimo, en `R Script`, como te muestro en la siguiente imagen.

```{r rstudio12, echo=F, fig.cap="", message=FALSE, warning=FALSE, fig.align="center", out.width='75%'}
knitr::include_graphics("https://raw.githubusercontent.com/7PartidasDigital/Taller-UVa/master/images/UVa_004.png")
```

Este `R Script` es donde har√°s todo el trabajo de programaci√≥n.

## Ejecutar un `script`{-}

Al contrario que la consola que viste antes, que ejecuta el c√≥digo inmediatamente, el editor no lo hace tan pronto como se pulsa ‚èé. Para conseguirlo, hay que situar el cursor en la primera l√≠nea de un comando del _script_, y pulsar simult√°neamente `CTRL/CMD+`‚èé (`CTRL` en Windows; `CMD` en Mac).

O se puede seleccionar todo un grupo de l√≠neas de c√≥digo que se quiere ejecutar y se pulsan a la vez `CTRL/CMD+`‚èé.

Tambi√©n se puede utilizar, el boton `Run` que hay en la parte superior derecha del editor. Tanto para ejecutar una sola l√≠nea de c√≥digo como todo un bloque (v√©ase la siguiente imagen).

```{r rstudio13, echo=F, fig.cap="", message=FALSE, warning=FALSE, fig.align="center", out.width='50%'}
knitr::include_graphics("https://raw.githubusercontent.com/7PartidasDigital/Taller-UVa/master/images/UVa_005.png")
```

# Comenzamos con R{-}

Esta secci√≥n introduce algunos conceptos y procedimientos b√°sicos que te ayudar√°n a optimiar el flujo de trabajo en R. 

## Preparando una sesi√≥n de R{-}

Al comienzo de una sesi√≥n de trabajo, es bueno definir una serie de par√°metros b√°sicos. No es obligatorio, ni siquiera necesario, pero puede ser √∫til a lo largo del trabajo. En la preparaci√≥n de una sesi√≥n de trabajo se pueden establecer una serie de opciones. En nuestro caso

+ queremos que R imprima los n√∫meros con decimales (y no que los presenten con notaci√≥n cient√≠fica, es decir, queremos ver 0.007 y no 0.7e^-3^))

+ quremos que R muestre un m√°ximo de 100 resultados (si no lo hacemos, es posible que R se pase un buen rato imprimendo ristras y ristras de n√∫meros).

De nuevo, estos preparativos de sesi√≥n no son obligatorios ni necesarios, pero pueden ayudar a evitar errores.

<div class="warning" style='padding:0.1em; background-color:#9b59b6; color:#f2f2f2'>
<span>
<p style='margin-top:1em; text-align:center'>
<b>ATENCI√ìN</b><br>Siempre que veas una caja gris como la que hay a continiaci√≥n, selecciona lo que haya en ella, c√≥rtalo y p√©galo en el editor de RStudio.<br></p>
<p style='margin-left:1em;'>
</p></span>
</div>


```{r, message=F, warning=F}
# establece opciones
options(stringsAsFactors = F)                    
options(scipen = 999) # establece que utilice la notaci√≥n cient√≠fica
options(max.print=100)
```

<div class="warning" style='padding:0.1em; background-color:#239b56; color:#f2f2f2'>
<span>
<p style='margin-top:1em; text-align:center'>
<b>NOTA</b><br>La primera l√≠nea del bloque anterior, que comienza con `#`, es un comentario y no se ejecutar√°, aunque fuera un l√≠nea de c√≥digo.<br>Tambi√©n lo he puesto en la segunda `option`, lo que hace es indicar o recordar qu√© es lo que hace esa l√≠nea de c√≥digo.<br>Es una pr√°ctica excelente comentar los _scripts_.</p>
<p style='margin-left:1em;'>
</p></span>
</div>

## Packages{-}

When using R, most of the functions are not loaded or even installing automatically. Instead, most functions are in contained in what are called **packages**. 

The bare-bone R comes with about 30 packages ("base R").  There are over 10,000 user-contributed packages; you can discover these packages online.  A prevalent collection of packages is the `tidyverse`, which includes `ggplot2`, a package for making graphics.

Before being able to use a package, we need to install the package (using the `install.packages` function) and load the package (using the `library` function). However, a package only needs to be installed once(!) and can then simply be loaded. When you install a package, this will likely install several other packages it depends on. You should have already installed `tidyverse`, `tidyverse`, `quanteda` and `tm` before the workshop, to save time and problems. 

You must load the package in any new R session where you want to use that package. Below I show what you need to type when you want to install the `tidyverse`, the `tidytext`,  the `quanteda`, and the `stopwords` packages (which are the packages that we will need in this workshop).

```{r, echo=T, eval=F, message=F, warning=F}
install.packages("tidyverse")
install.packages("tidytext")
install.packages("quanteda")
install.packages("stopwords")
```

To load these packages, use the `library` function which takes the package name as its main argument.

```{r message=FALSE, warning=FALSE}
library(tidyverse)
library(tidytext)
library(quanteda)
library(stopwords)
```

The session preparation section of your script file will thus also state which packages a script relies on.

In the script editor pane of RStudio, the code blocks that install and activate packages would look like this:

```{r echo=F, fig.cap="", message=FALSE, warning=FALSE, out.width='10%'}
knitr::include_graphics("https://raw.githubusercontent.com/7PartidasDigital/MLex/master/image/MLex_006.png")
``` 

The lines starting with *#* and printed in green are comments. They are very useful to remind you what a line or chunk of code does.

## Getting help{-}

When working with R, you will encounter issues and face challenges. A very good thing about R is that it provides various ways to get help or find information about the issues you face.

### Finding help within R{-}

To get help regrading what functions a package contains, which arguments a function takes or to get information about how to use a function, you can use the `help` function or you can simply type a `?` before the package or or function. I you run any of these two instruccions in the Console pane, the Help tab on the botton right pane will show the answer.

```{r intro_01_11, echo=TRUE, eval=F, warning=F, message=F}
help(library) 
?library
```


```{r echo=F, fig.cap="", message=FALSE, warning=FALSE, out.width='25%'}
knitr::include_graphics("https://raw.githubusercontent.com/7PartidasDigital/MLex/master/image/MLex_007.png")
``` 

There are also other "official" help resources from R/RStudio. 

* Read official package documentation, see vignettes, e.g., Tidyverse <https://cran.r-project.org/package=tidyverse>

* Use the RStudio Cheat Sheets at <https://www.rstudio.com/resources/cheatsheets/>

* Check out the keyboard shortcuts `Help` under `Tools` in RStudio for some good tips 

### Finding help online{-}

Una de las mejores cosas de R es que puedes encontrar la soluci√≥n a tus preguntas y problemas en la red. [R-bloggers](https://www.r-bloggers.com/) y [Stackoverflow](https://stackoverflow.com/questions/tagged/r) son sitios magn√≠ficos para localizar trucos y ayuda.

<div>
<center>
<img src="https://raw.githubusercontent.com/7PartidasDigital/MLex/master/image/R_google.png" width="500"/>
</center>
</div>

Desde el aparici√≥n de la IA generativa del tipo ChatGPT o Copilot, se puede recurrir a ella para que te ayude a solucionar un problema en un _script_. Al reescibir partes del c√≥digo de este taller, recuper√© un _script_ que me dio un error y no sab√≠a cu√°l era. hab√≠a escrito el c√≥digo hace dos o tres a√±os y no lo document√© adecuadamente con `#`. Copilot en segundos me dijo donde estaba el error. ¬°Hab√≠a olvidado cargar una librer√≠a!

```{r echo=F, fig.cap="", message=FALSE, warning=FALSE, fig.align="center", out.width='50%'}
knitr::include_graphics("https://raw.githubusercontent.com/7PartidasDigital/Taller-UVa/master/images/UVa_012.png")
``` 


<div class="warning" style='padding:0.1em; background-color:#804000; color:#f2f2f2'>
<span>
<p style='margin-top:1em; text-align:center'>
<b>NOTE</b>
<br>Este `R Notebook` en tutoriales de [Ladal](https://ladal.edu.au/tutorials.html), [Programming Historian](https://programminghistorian.org/en/lessons/basic-text-processing-in-r) y [CuentaPalabras](http://www.aic.uva.es/cuentapalabras/).<br>Para los interesados en la ling√ºistica recomiendo vivamente los tutoriales de **Ladal**.</p>
<p style='margin-left:1em;'>
</p></span>
</div>

<div>
<center>
<img src="https://raw.githubusercontent.com/7PartidasDigital/MLex/master/image/EXPLICIT-7PARTIDAS.png"/>
<br>PID2020-112621GB-I00/AEI/10.13039/501100011033
</center>
</div>
